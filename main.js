/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var U=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var q=Object.prototype.hasOwnProperty;var G=(i,a)=>{for(var e in a)U(i,e,{get:a[e],enumerable:!0})},z=(i,a,e,t)=>{if(a&&typeof a=="object"||typeof a=="function")for(let s of _(a))!q.call(i,s)&&s!==e&&U(i,s,{get:()=>a[s],enumerable:!(t=F(a,s))||t.enumerable});return i};var K=i=>z(U({},"__esModule",{value:!0}),i);var he={};G(he,{default:()=>R});module.exports=K(he);var u=require("obsidian");var Y=Object.prototype.toString,E=Array.isArray||function(a){return Y.call(a)==="[object Array]"};function O(i){return typeof i=="function"}function J(i){return E(i)?"array":typeof i}function B(i){return i.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function W(i,a){return i!=null&&typeof i=="object"&&a in i}function Q(i,a){return i!=null&&typeof i!="object"&&i.hasOwnProperty&&i.hasOwnProperty(a)}var X=RegExp.prototype.test;function Z(i,a){return X.call(i,a)}var ee=/\S/;function te(i){return!Z(ee,i)}var se={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function ae(i){return String(i).replace(/[&<>"'`=\/]/g,function(e){return se[e]})}var ne=/\s*/,re=/\s+/,j=/\s*=/,ie=/\s*\}/,le=/#|\^|\/|>|\{|&|=|!/;function oe(i,a){if(!i)return[];var e=!1,t=[],s=[],n=[],r=!1,l=!1,o="",c=0;function p(){if(r&&!l)for(;n.length;)delete s[n.pop()];else n=[];r=!1,l=!1}var d,T,A;function N(w){if(typeof w=="string"&&(w=w.split(re,2)),!E(w)||w.length!==2)throw new Error("Invalid tags: "+w);d=new RegExp(B(w[0])+"\\s*"),T=new RegExp("\\s*"+B(w[1])),A=new RegExp("\\s*"+B("}"+w[1]))}N(a||v.tags);for(var h=new V(i),y,f,g,b,k,C;!h.eos();){if(y=h.pos,g=h.scanUntil(d),g)for(var M=0,H=g.length;M<H;++M)b=g.charAt(M),te(b)?(n.push(s.length),o+=b):(l=!0,e=!0,o+=" "),s.push(["text",b,y,y+1]),y+=1,b===`
`&&(p(),o="",c=0,e=!1);if(!h.scan(d))break;if(r=!0,f=h.scan(le)||"name",h.scan(ne),f==="="?(g=h.scanUntil(j),h.scan(j),h.scanUntil(T)):f==="{"?(g=h.scanUntil(A),h.scan(ie),h.scanUntil(T),f="&"):g=h.scanUntil(T),!h.scan(T))throw new Error("Unclosed tag at "+h.pos);if(f==">"?k=[f,g,y,h.pos,o,c,e]:k=[f,g,y,h.pos],c++,s.push(k),f==="#"||f==="^")t.push(k);else if(f==="/"){if(C=t.pop(),!C)throw new Error('Unopened section "'+g+'" at '+y);if(C[1]!==g)throw new Error('Unclosed section "'+C[1]+'" at '+y)}else f==="name"||f==="{"||f==="&"?l=!0:f==="="&&N(g)}if(p(),C=t.pop(),C)throw new Error('Unclosed section "'+C[1]+'" at '+h.pos);return pe(ce(s))}function ce(i){for(var a=[],e,t,s=0,n=i.length;s<n;++s)e=i[s],e&&(e[0]==="text"&&t&&t[0]==="text"?(t[1]+=e[1],t[3]=e[3]):(a.push(e),t=e));return a}function pe(i){for(var a=[],e=a,t=[],s,n,r=0,l=i.length;r<l;++r)switch(s=i[r],s[0]){case"#":case"^":e.push(s),t.push(s),e=s[4]=[];break;case"/":n=t.pop(),n[5]=s[2],e=t.length>0?t[t.length-1][4]:a;break;default:e.push(s)}return a}function V(i){this.string=i,this.tail=i,this.pos=0}V.prototype.eos=function(){return this.tail===""};V.prototype.scan=function(a){var e=this.tail.match(a);if(!e||e.index!==0)return"";var t=e[0];return this.tail=this.tail.substring(t.length),this.pos+=t.length,t};V.prototype.scanUntil=function(a){var e=this.tail.search(a),t;switch(e){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,e),this.tail=this.tail.substring(e)}return this.pos+=t.length,t};function x(i,a){this.view=i,this.cache={".":this.view},this.parent=a}x.prototype.push=function(a){return new x(a,this)};x.prototype.lookup=function(a){var e=this.cache,t;if(e.hasOwnProperty(a))t=e[a];else{for(var s=this,n,r,l,o=!1;s;){if(a.indexOf(".")>0)for(n=s.view,r=a.split("."),l=0;n!=null&&l<r.length;)l===r.length-1&&(o=W(n,r[l])||Q(n,r[l])),n=n[r[l++]];else n=s.view[a],o=W(s.view,a);if(o){t=n;break}s=s.parent}e[a]=t}return O(t)&&(t=t.call(this.view)),t};function m(){this.templateCache={_cache:{},set:function(a,e){this._cache[a]=e},get:function(a){return this._cache[a]},clear:function(){this._cache={}}}}m.prototype.clearCache=function(){typeof this.templateCache!="undefined"&&this.templateCache.clear()};m.prototype.parse=function(a,e){var t=this.templateCache,s=a+":"+(e||v.tags).join(":"),n=typeof t!="undefined",r=n?t.get(s):void 0;return r==null&&(r=oe(a,e),n&&t.set(s,r)),r};m.prototype.render=function(a,e,t,s){var n=this.getConfigTags(s),r=this.parse(a,n),l=e instanceof x?e:new x(e,void 0);return this.renderTokens(r,l,t,a,s)};m.prototype.renderTokens=function(a,e,t,s,n){for(var r="",l,o,c,p=0,d=a.length;p<d;++p)c=void 0,l=a[p],o=l[0],o==="#"?c=this.renderSection(l,e,t,s,n):o==="^"?c=this.renderInverted(l,e,t,s,n):o===">"?c=this.renderPartial(l,e,t,n):o==="&"?c=this.unescapedValue(l,e):o==="name"?c=this.escapedValue(l,e,n):o==="text"&&(c=this.rawValue(l)),c!==void 0&&(r+=c);return r};m.prototype.renderSection=function(a,e,t,s,n){var r=this,l="",o=e.lookup(a[1]);function c(T){return r.render(T,e,t,n)}if(o){if(E(o))for(var p=0,d=o.length;p<d;++p)l+=this.renderTokens(a[4],e.push(o[p]),t,s,n);else if(typeof o=="object"||typeof o=="string"||typeof o=="number")l+=this.renderTokens(a[4],e.push(o),t,s,n);else if(O(o)){if(typeof s!="string")throw new Error("Cannot use higher-order sections without the original template");o=o.call(e.view,s.slice(a[3],a[5]),c),o!=null&&(l+=o)}else l+=this.renderTokens(a[4],e,t,s,n);return l}};m.prototype.renderInverted=function(a,e,t,s,n){var r=e.lookup(a[1]);if(!r||E(r)&&r.length===0)return this.renderTokens(a[4],e,t,s,n)};m.prototype.indentPartial=function(a,e,t){for(var s=e.replace(/[^ \t]/g,""),n=a.split(`
`),r=0;r<n.length;r++)n[r].length&&(r>0||!t)&&(n[r]=s+n[r]);return n.join(`
`)};m.prototype.renderPartial=function(a,e,t,s){if(t){var n=this.getConfigTags(s),r=O(t)?t(a[1]):t[a[1]];if(r!=null){var l=a[6],o=a[5],c=a[4],p=r;o==0&&c&&(p=this.indentPartial(r,c,l));var d=this.parse(p,n);return this.renderTokens(d,e,t,p,s)}}};m.prototype.unescapedValue=function(a,e){var t=e.lookup(a[1]);if(t!=null)return t};m.prototype.escapedValue=function(a,e,t){var s=this.getConfigEscape(t)||v.escape,n=e.lookup(a[1]);if(n!=null)return typeof n=="number"&&s===v.escape?String(n):s(n)};m.prototype.rawValue=function(a){return a[1]};m.prototype.getConfigTags=function(a){return E(a)?a:a&&typeof a=="object"?a.tags:void 0};m.prototype.getConfigEscape=function(a){if(a&&typeof a=="object"&&!E(a))return a.escape};var v={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(i){P.templateCache=i},get templateCache(){return P.templateCache}},P=new m;v.clearCache=function(){return P.clearCache()};v.parse=function(a,e){return P.parse(a,e)};v.render=function(a,e,t,s){if(typeof a!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+J(a)+'" was given as the first argument for mustache#render(template, view, partials)');return P.render(a,e,t,s)};v.escape=ae;v.Scanner=V;v.Context=x;v.Writer=m;var ue={templates:[{id:"default",name:"Styled H1",content:`<h1 style=" text-align: center; font-size: 3em; font-family: 'Georgia', serif; color: #2c3e50; margin: 0.5em 0; padding: 10px 0; border-top: 4px solid #3498db; border-bottom: 4px solid #3498db; text-transform: uppercase; letter-spacing: 3px;">{{selectedText}}</h1>`,params:["selectedText"],defaultValues:{selectedText:"Welcome to Mustache Template."}},{id:"default",name:"Styled H1",content:`<h1 style=" text-align: center; font-size: 3em; font-family: 'Georgia', serif; color: #2c3e50; margin: 0.5em 0; padding: 10px 0; border-top: 4px solid #3498db; border-bottom: 4px solid #3498db; text-transform: uppercase; letter-spacing: 3px;">{{selectedText}}</h1>`,params:["selectedText"],defaultValues:{selectedText:"Welcome to Mustache Template."}}]},R=class extends u.Plugin{async onload(){await this.loadSettings(),this.addCommand({id:"insert-template",name:"Insert template with parameters",editorCallback:(e,t)=>{let s=e.getSelection()||"",n=e.getCursor();if(this.settings.templates.length===0){new u.Notice("No templates configured. Please add a template in settings.");return}new I(this.app,this.settings.templates,s,r=>{s?e.replaceSelection(r):e.replaceRange(r,n)}).open()}}),this.registerTemplateCommands(),this.registerEditorMenu(),this.addSettingTab(new $(this.app,this))}onunload(){let e=this.app.commands;e&&typeof e.listCommands=="function"&&e.listCommands().filter(t=>t.id.startsWith("mustache-template-inserter:template-")).forEach(t=>{typeof e.removeCommand=="function"&&e.removeCommand(t.id)})}async loadSettings(){this.settings=Object.assign({},ue,await this.loadData()),this.settings.templates.forEach(e=>{e.params||(e.params=this.extractParamsFromTemplate(e.content))})}extractParamsFromTemplate(e){let t=new Set,s=/\{\{([^#^\/!><=\s{}]+)\}\}/g,n;for(;(n=s.exec(e))!==null;){let l=n[1].trim();t.add(l)}let r=/\{\{#([^><=\s{}]+)\}\}/g;for(;(n=r.exec(e))!==null;){let l=n[1].trim();t.add(l)}return Array.from(t)}async saveSettings(){await this.saveData(this.settings)}registerTemplateCommands(){let e=this.app.commands;e&&typeof e.listCommands=="function"&&e.listCommands().filter(t=>t.id.startsWith("mustache-template-inserter:template-")).forEach(t=>{typeof e.removeCommand=="function"&&e.removeCommand(t.id)}),this.settings.templates.forEach(t=>{t.isCommand&&this.addCommand({id:`template-${t.id}`,name:`Template: ${t.name}`,editorCallback:(s,n)=>{var o;let r=s.getSelection()||((o=t.defaultValues)==null?void 0:o.selectedText)||"",l=s.getCursor();if(t.params&&t.params.length>0)new D(this.app,t,r,c=>{s.getSelection()?s.replaceSelection(c):s.replaceRange(c,l)}).open();else try{let c={selectedText:r},p=(void 0)(t.content,c);s.getSelection()?s.replaceSelection(p):s.replaceRange(p,l)}catch(c){console.error("Template processing error:",c),new u.Notice(`Template error: ${c instanceof Error?c.message:String(c)}`)}}})})}registerEditorMenu(){this.registerEvent(this.app.workspace.on("editor-menu",(e,t)=>{let s=this.settings.templates.filter(n=>n.isCommand);s.length>0&&(e.addItem(n=>{n.setTitle("\u6A21\u677F\u63D2\u5165").setIcon("text-cursor-input").setSection("templater").onClick(()=>{let r=t.getSelection()||"",l=t.getCursor();new I(this.app,this.settings.templates,r,o=>{t.getSelection()?t.replaceSelection(o):t.replaceRange(o,l)}).open()})}),s.forEach(n=>{e.addItem(r=>{r.setTitle(`\u6A21\u677F: ${n.name}`).setSection("templater").onClick(()=>{var c;let l=t.getSelection()||((c=n.defaultValues)==null?void 0:c.selectedText)||"",o=t.getCursor();if(n.params&&n.params.length>0)new D(this.app,n,l,p=>{t.getSelection()?t.replaceSelection(p):t.replaceRange(p,o)}).open();else try{let p={selectedText:l},d=(void 0)(n.content,p);t.getSelection()?t.replaceSelection(d):t.replaceRange(d,o)}catch(p){console.error("Template processing error:",p),new u.Notice(`Template error: ${p instanceof Error?p.message:String(p)}`)}})})}))}))}},I=class extends u.Modal{constructor(e,t,s,n){super(e);this.templates=t,this.selectedText=s,this.onSubmit=n}onOpen(){let{contentEl:e}=this;e.addClass("template-selection-modal"),e.createEl("h2",{text:"Select Template"}),this.templates.forEach(t=>{new u.Setting(e).setName(t.name).addButton(s=>s.setButtonText("Use").setCta().onClick(()=>{var n,r;if(this.close(),t.params&&t.params.length>0){let l=this.selectedText||((n=t.defaultValues)==null?void 0:n.selectedText)||"";new D(this.app,t,l,this.onSubmit).open()}else try{let o={selectedText:this.selectedText||((r=t.defaultValues)==null?void 0:r.selectedText)||""},c=(void 0)(t.content,o);this.onSubmit(c)}catch(l){console.error("Template processing error:",l),new u.Notice(`Template error: ${l instanceof Error?l.message:String(l)}`)}}))})}onClose(){let{contentEl:e}=this;e.empty()}},D=class extends u.Modal{constructor(e,t,s,n){super(e);this.paramValues={};this.paramInputs={};this.template=t,this.selectedText=s,this.onSubmit=n,this.template.params&&this.template.params.forEach(r=>{var l;r==="selectedText"&&s?this.paramValues[r]=s:this.paramValues[r]=((l=this.template.defaultValues)==null?void 0:l[r])||""})}onOpen(){let{contentEl:e}=this;if(e.addClass("template-parameter-modal"),!this.template.params||this.template.params.length===0){this.processTemplate(),this.close();return}e.createEl("h2",{text:"Enter Template Parameters"});let t=e.createEl("form");t.addEventListener("submit",s=>{s.preventDefault(),this.processTemplate()}),this.template.params.forEach(s=>{new u.Setting(t).setName(s).setDesc(`Enter value for ${s}`).addText(r=>{var o;this.paramInputs[s]=r;let l=((o=this.template.defaultValues)==null?void 0:o[s])||"";r.setValue(l).setPlaceholder(`Enter ${s}`).onChange(c=>{this.paramValues[s]=c})})}),new u.Setting(t).addButton(s=>s.setButtonText("Insert Template").setCta().onClick(()=>{this.processTemplate()})),setTimeout(()=>{var n,r;let s=(n=this.template.params)==null?void 0:n[0];s&&((r=this.paramInputs[s])!=null&&r.inputEl)&&this.paramInputs[s].inputEl.focus()},10)}processTemplate(){try{let e={...this.paramValues,selectedText:this.selectedText},t="";try{t=(void 0)(this.template.content,e)}catch(s){console.error("Mustache render error:",s),t=this.template.content,Object.keys(e).forEach(n=>{let r=e[n]||"",l=new RegExp(`\\{\\{\\s*${n}\\s*\\}\\}`,"g");t=t.replace(l,r)}),t=t.replace(/\{\{#.*?\}\}[\s\S]*?\{\{\/.*?\}\}/g,"")}this.onSubmit(t),this.close()}catch(e){console.error("Template processing error:",e),new u.Notice(`Template error: ${e instanceof Error?e.message:String(e)}`)}}onClose(){let{contentEl:e}=this;e.empty()}},$=class extends u.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Template Manager"}),e.createEl("p",{text:"Create and manage your templates here."}),new u.Setting(e).setName("Add New Template").setDesc("Create a new template").addButton(s=>s.setButtonText("Add Template").setCta().onClick(()=>{this.plugin.settings.templates.push({id:String(Date.now()),name:"New Template",content:"{{selectedText}}",params:[],defaultValues:{},isCommand:!1}),this.plugin.saveSettings(),this.display()})),e.createEl("h3",{text:"Your Templates"});let t=e.createDiv("templates-container");t.createEl("p",{text:"Remember to Exit Obsidian APP, after save any changes."}),this.plugin.settings.templates.forEach((s,n)=>{let r=t.createDiv("template-item-container"),l=r.createDiv("template-header");l.createDiv("template-name").setText(s.name);let o=l.createDiv("template-toggle-container"),c=new u.Setting(o).setClass("template-command-toggle").addToggle(h=>{h.setValue(s.isCommand||!1).onChange(async y=>{s.isCommand=y,await this.plugin.saveSettings(),this.plugin.registerTemplateCommands()})}),p=r.createDiv("template-preview-container"),d=s.content?s.content.substring(0,s.content.length>100?100:s.content.length):"<empty>";p.createEl("input",{type:"text",attr:{readonly:"readonly",value:d,style:"width: 100%; border: 1px solid var(--background-modifier-border); border-radius: 4px; padding: 8px;"}});let T=r.createDiv("template-button-container");T.createEl("button",{text:"Edit",cls:"template-edit-button"}).addEventListener("click",()=>{new L(this.app,s,async h=>{this.plugin.settings.templates[n]=h,await this.plugin.saveSettings(),this.display()}).open()}),T.createEl("button",{text:"Delete",cls:"template-delete-button"}).addEventListener("click",async()=>{this.plugin.settings.templates.splice(n,1),await this.plugin.saveSettings(),this.display()})})}},L=class extends u.Modal{constructor(e,t,s){super(e);this.templateParams=[];this.templateDefaultValues={};this.template=t,this.onSubmit=s,this.templateContent=t.content,this.templateName=t.name,this.templateParams=t.params?[...t.params]:[],this.templateDefaultValues=t.defaultValues?{...t.defaultValues}:{},this.templateIsCommand=t.isCommand||!1}onOpen(){let{contentEl:e}=this;e.addClass("template-edit-modal"),e.createEl("h2",{text:"Edit Template"}),new u.Setting(e).setName("Template Name").addText(r=>r.setPlaceholder("Template name").setValue(this.templateName).onChange(l=>{this.templateName=l})),new u.Setting(e).setName("Add to right-click menu command").setDesc("Add this template to the context menu on the right side of the editor").addToggle(r=>{r.setValue(this.templateIsCommand).onChange(l=>{this.templateIsCommand=l})}),e.createEl("h3",{text:"Template Content"}),e.createEl("p",{text:"Use {{paramName}} for parameters. {{selectedText}} is always available.",cls:"setting-item-description"});let s=e.createDiv().createEl("textarea",{attr:{rows:"10",style:"width: 100%; font-family: monospace;"}});s.value=this.templateContent,s.addEventListener("input",r=>{let l=r.target;this.templateContent=l.value;let o=this.app.plugins.plugins["obsidian-template-inserter"];if(o){let c=o.extractParamsFromTemplate(this.templateContent);c.forEach(p=>{this.templateParams.includes(p)||(this.templateDefaultValues[p]="")}),this.templateParams.forEach(p=>{!c.includes(p)&&this.templateDefaultValues[p]!==void 0&&delete this.templateDefaultValues[p]}),this.templateParams=c,this.updateParamsList()}}),e.createEl("h3",{text:"Template Parameters & Default Values"});let n=e.createDiv("template-params-container");this.updateParamsList(n),new u.Setting(e).addButton(r=>r.setButtonText("Save Template").setCta().onClick(()=>{let l={id:this.template.id,name:this.templateName,content:this.templateContent,params:this.templateParams,defaultValues:this.templateDefaultValues,isCommand:this.templateIsCommand};this.onSubmit(l),this.close()}))}updateParamsList(e){if(!e){let t=this.contentEl.querySelector(".template-params-container");if(!t)return;e=t}e.empty(),this.templateParams.length===0?e.createEl("p",{text:"No parameters detected. Use {{paramName}} syntax in your template.",cls:"no-params-message"}):this.templateParams.forEach(t=>{e&&new u.Setting(e).setName(t).setDesc("Set default value (optional)").addText(n=>{let r=this.templateDefaultValues[t]||"";n.setPlaceholder("Default value").setValue(r).onChange(l=>{this.templateDefaultValues[t]=l})})})}onClose(){let{contentEl:e}=this;e.empty()}};
/*! Bundled license information:

mustache/mustache.mjs:
  (*!
   * mustache.js - Logic-less {{mustache}} templates with JavaScript
   * http://github.com/janl/mustache.js
   *)
*/
