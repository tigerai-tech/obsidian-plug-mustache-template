/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var U=Object.defineProperty;var H=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var q=Object.prototype.hasOwnProperty;var G=(l,a)=>{for(var e in a)U(l,e,{get:a[e],enumerable:!0})},Y=(l,a,e,t)=>{if(a&&typeof a=="object"||typeof a=="function")for(let s of _(a))!q.call(l,s)&&s!==e&&U(l,s,{get:()=>a[s],enumerable:!(t=H(a,s))||t.enumerable});return l};var z=l=>Y(U({},"__esModule",{value:!0}),l);var he={};G(he,{default:()=>k});module.exports=z(he);var h=require("obsidian");var K=Object.prototype.toString,E=Array.isArray||function(a){return K.call(a)==="[object Array]"};function O(l){return typeof l=="function"}function J(l){return E(l)?"array":typeof l}function B(l){return l.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function L(l,a){return l!=null&&typeof l=="object"&&a in l}function Q(l,a){return l!=null&&typeof l!="object"&&l.hasOwnProperty&&l.hasOwnProperty(a)}var X=RegExp.prototype.test;function Z(l,a){return X.call(l,a)}var ee=/\S/;function te(l){return!Z(ee,l)}var se={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function ae(l){return String(l).replace(/[&<>"'`=\/]/g,function(e){return se[e]})}var ne=/\s*/,re=/\s+/,j=/\s*=/,ie=/\s*\}/,le=/#|\^|\/|>|\{|&|=|!/;function oe(l,a){if(!l)return[];var e=!1,t=[],s=[],n=[],r=!1,i=!1,o="",p=0;function c(){if(r&&!i)for(;n.length;)delete s[n.pop()];else n=[];r=!1,i=!1}var u,g,A;function N(w){if(typeof w=="string"&&(w=w.split(re,2)),!E(w)||w.length!==2)throw new Error("Invalid tags: "+w);u=new RegExp(B(w[0])+"\\s*"),g=new RegExp("\\s*"+B(w[1])),A=new RegExp("\\s*"+B("}"+w[1]))}N(a||T.tags);for(var m=new P(l),y,f,v,b,R,x;!m.eos();){if(y=m.pos,v=m.scanUntil(u),v)for(var M=0,W=v.length;M<W;++M)b=v.charAt(M),te(b)?(n.push(s.length),o+=b):(i=!0,e=!0,o+=" "),s.push(["text",b,y,y+1]),y+=1,b===`
`&&(c(),o="",p=0,e=!1);if(!m.scan(u))break;if(r=!0,f=m.scan(le)||"name",m.scan(ne),f==="="?(v=m.scanUntil(j),m.scan(j),m.scanUntil(g)):f==="{"?(v=m.scanUntil(A),m.scan(ie),m.scanUntil(g),f="&"):v=m.scanUntil(g),!m.scan(g))throw new Error("Unclosed tag at "+m.pos);if(f==">"?R=[f,v,y,m.pos,o,p,e]:R=[f,v,y,m.pos],p++,s.push(R),f==="#"||f==="^")t.push(R);else if(f==="/"){if(x=t.pop(),!x)throw new Error('Unopened section "'+v+'" at '+y);if(x[1]!==v)throw new Error('Unclosed section "'+x[1]+'" at '+y)}else f==="name"||f==="{"||f==="&"?i=!0:f==="="&&N(v)}if(c(),x=t.pop(),x)throw new Error('Unclosed section "'+x[1]+'" at '+m.pos);return pe(ce(s))}function ce(l){for(var a=[],e,t,s=0,n=l.length;s<n;++s)e=l[s],e&&(e[0]==="text"&&t&&t[0]==="text"?(t[1]+=e[1],t[3]=e[3]):(a.push(e),t=e));return a}function pe(l){for(var a=[],e=a,t=[],s,n,r=0,i=l.length;r<i;++r)switch(s=l[r],s[0]){case"#":case"^":e.push(s),t.push(s),e=s[4]=[];break;case"/":n=t.pop(),n[5]=s[2],e=t.length>0?t[t.length-1][4]:a;break;default:e.push(s)}return a}function P(l){this.string=l,this.tail=l,this.pos=0}P.prototype.eos=function(){return this.tail===""};P.prototype.scan=function(a){var e=this.tail.match(a);if(!e||e.index!==0)return"";var t=e[0];return this.tail=this.tail.substring(t.length),this.pos+=t.length,t};P.prototype.scanUntil=function(a){var e=this.tail.search(a),t;switch(e){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,e),this.tail=this.tail.substring(e)}return this.pos+=t.length,t};function C(l,a){this.view=l,this.cache={".":this.view},this.parent=a}C.prototype.push=function(a){return new C(a,this)};C.prototype.lookup=function(a){var e=this.cache,t;if(e.hasOwnProperty(a))t=e[a];else{for(var s=this,n,r,i,o=!1;s;){if(a.indexOf(".")>0)for(n=s.view,r=a.split("."),i=0;n!=null&&i<r.length;)i===r.length-1&&(o=L(n,r[i])||Q(n,r[i])),n=n[r[i++]];else n=s.view[a],o=L(s.view,a);if(o){t=n;break}s=s.parent}e[a]=t}return O(t)&&(t=t.call(this.view)),t};function d(){this.templateCache={_cache:{},set:function(a,e){this._cache[a]=e},get:function(a){return this._cache[a]},clear:function(){this._cache={}}}}d.prototype.clearCache=function(){typeof this.templateCache!="undefined"&&this.templateCache.clear()};d.prototype.parse=function(a,e){var t=this.templateCache,s=a+":"+(e||T.tags).join(":"),n=typeof t!="undefined",r=n?t.get(s):void 0;return r==null&&(r=oe(a,e),n&&t.set(s,r)),r};d.prototype.render=function(a,e,t,s){var n=this.getConfigTags(s),r=this.parse(a,n),i=e instanceof C?e:new C(e,void 0);return this.renderTokens(r,i,t,a,s)};d.prototype.renderTokens=function(a,e,t,s,n){for(var r="",i,o,p,c=0,u=a.length;c<u;++c)p=void 0,i=a[c],o=i[0],o==="#"?p=this.renderSection(i,e,t,s,n):o==="^"?p=this.renderInverted(i,e,t,s,n):o===">"?p=this.renderPartial(i,e,t,n):o==="&"?p=this.unescapedValue(i,e):o==="name"?p=this.escapedValue(i,e,n):o==="text"&&(p=this.rawValue(i)),p!==void 0&&(r+=p);return r};d.prototype.renderSection=function(a,e,t,s,n){var r=this,i="",o=e.lookup(a[1]);function p(g){return r.render(g,e,t,n)}if(o){if(E(o))for(var c=0,u=o.length;c<u;++c)i+=this.renderTokens(a[4],e.push(o[c]),t,s,n);else if(typeof o=="object"||typeof o=="string"||typeof o=="number")i+=this.renderTokens(a[4],e.push(o),t,s,n);else if(O(o)){if(typeof s!="string")throw new Error("Cannot use higher-order sections without the original template");o=o.call(e.view,s.slice(a[3],a[5]),p),o!=null&&(i+=o)}else i+=this.renderTokens(a[4],e,t,s,n);return i}};d.prototype.renderInverted=function(a,e,t,s,n){var r=e.lookup(a[1]);if(!r||E(r)&&r.length===0)return this.renderTokens(a[4],e,t,s,n)};d.prototype.indentPartial=function(a,e,t){for(var s=e.replace(/[^ \t]/g,""),n=a.split(`
`),r=0;r<n.length;r++)n[r].length&&(r>0||!t)&&(n[r]=s+n[r]);return n.join(`
`)};d.prototype.renderPartial=function(a,e,t,s){if(t){var n=this.getConfigTags(s),r=O(t)?t(a[1]):t[a[1]];if(r!=null){var i=a[6],o=a[5],p=a[4],c=r;o==0&&p&&(c=this.indentPartial(r,p,i));var u=this.parse(c,n);return this.renderTokens(u,e,t,c,s)}}};d.prototype.unescapedValue=function(a,e){var t=e.lookup(a[1]);if(t!=null)return t};d.prototype.escapedValue=function(a,e,t){var s=this.getConfigEscape(t)||T.escape,n=e.lookup(a[1]);if(n!=null)return typeof n=="number"&&s===T.escape?String(n):s(n)};d.prototype.rawValue=function(a){return a[1]};d.prototype.getConfigTags=function(a){return E(a)?a:a&&typeof a=="object"?a.tags:void 0};d.prototype.getConfigEscape=function(a){if(a&&typeof a=="object"&&!E(a))return a.escape};var T={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(l){V.templateCache=l},get templateCache(){return V.templateCache}},V=new d;T.clearCache=function(){return V.clearCache()};T.parse=function(a,e){return V.parse(a,e)};T.render=function(a,e,t,s){if(typeof a!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+J(a)+'" was given as the first argument for mustache#render(template, view, partials)');return V.render(a,e,t,s)};T.escape=ae;T.Scanner=P;T.Context=C;T.Writer=d;var ue={templates:[{id:"default",name:"Styled H1",content:`<h1 style=" text-align: center; font-size: 3em; font-family: 'Georgia', serif; color: #2c3e50; margin: 0.5em 0; padding: 10px 0; border-top: 4px solid #3498db; border-bottom: 4px solid #3498db; text-transform: uppercase; letter-spacing: 3px;">{{selectedText}}</h1>`,params:["selectedText"],defaultValues:{selectedText:"Welcome to Mustache Template."}},{id:"1746685230032",name:"YellowBgText",content:'<font style="background-color: #FFFACD; color:{{color}}; padding: 4px; border-radius: 8px; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); font-weight: bold;">{{selectedText}}</font>',params:["color","selectedText"],defaultValues:{selectedText:"",color:"tomato"},isCommand:!0}]},k=class extends h.Plugin{async onload(){await this.loadSettings(),this.addCommand({id:"insert-template",name:"Insert template with parameters",editorCallback:(e,t)=>{let s=e.getSelection()||"",n=e.getCursor();if(this.settings.templates.length===0){new h.Notice("No templates configured. Please add a template in settings.");return}new I(this.app,this.settings.templates,s,r=>{s?e.replaceSelection(r):e.replaceRange(r,n)}).open()}}),this.registerTemplateCommands(),this.registerEditorMenu(),this.addSettingTab(new $(this.app,this))}onunload(){let e=this.app.commands;e&&typeof e.listCommands=="function"&&e.listCommands().filter(t=>t.id.startsWith("mustache-template-inserter:template-")).forEach(t=>{typeof e.removeCommand=="function"&&e.removeCommand(t.id)})}async loadSettings(){this.settings=Object.assign({},ue,await this.loadData()),this.settings.templates.forEach(e=>{e.params||(e.params=this.extractParamsFromTemplate(e.content))})}extractParamsFromTemplate(e){let t=new Set,s=/\{\{([^#^\/!><=\s{}]+)\}\}/g,n;for(;(n=s.exec(e))!==null;){let i=n[1].trim();t.add(i)}let r=/\{\{#([^><=\s{}]+)\}\}/g;for(;(n=r.exec(e))!==null;){let i=n[1].trim();t.add(i)}return Array.from(t)}async saveSettings(){await this.saveData(this.settings)}registerTemplateCommands(){let e=this.app.commands;e&&typeof e.listCommands=="function"&&e.listCommands().filter(t=>t.id.startsWith("mustache-template-inserter:template-")).forEach(t=>{typeof e.removeCommand=="function"&&e.removeCommand(t.id)}),this.settings.templates.forEach(t=>{t.isCommand&&this.addCommand({id:`template-${t.id}`,name:`Template: ${t.name}`,editorCallback:(s,n)=>{var o;let r=s.getSelection()||((o=t.defaultValues)==null?void 0:o.selectedText)||"",i=s.getCursor();if(t.params&&t.params.length>0){let p={};t.params.forEach(c=>{var u;c==="selectedText"?p[c]=r:p[c]=((u=t.defaultValues)==null?void 0:u[c])||""}),new D(this.app,t,r,c=>{s.getSelection()?s.replaceSelection(c):s.replaceRange(c,i)},p).open()}else try{let p={selectedText:r},c=(void 0)(t.content,p);s.getSelection()?s.replaceSelection(c):s.replaceRange(c,i)}catch(p){console.error("Template processing error:",p),new h.Notice(`Template error: ${p instanceof Error?p.message:String(p)}`)}}})})}registerEditorMenu(){this.registerEvent(this.app.workspace.on("editor-menu",(e,t)=>{let s=this.settings.templates.filter(n=>n.isCommand);s.length>0&&(e.addItem(n=>{n.setTitle("\u6A21\u677F\u63D2\u5165").setIcon("text-cursor-input").setSection("templater").onClick(()=>{let r=t.getSelection()||"",i=t.getCursor();new I(this.app,this.settings.templates,r,o=>{t.getSelection()?t.replaceSelection(o):t.replaceRange(o,i)}).open()})}),s.forEach(n=>{e.addItem(r=>{r.setTitle(`\u6A21\u677F: ${n.name}`).setSection("templater").onClick(()=>{var p;let i=t.getSelection()||((p=n.defaultValues)==null?void 0:p.selectedText)||"",o=t.getCursor();if(n.params&&n.params.length>0){let c={};n.params.forEach(u=>{var g;u==="selectedText"?c[u]=i:c[u]=((g=n.defaultValues)==null?void 0:g[u])||""}),new D(this.app,n,i,u=>{t.getSelection()?t.replaceSelection(u):t.replaceRange(u,o)},c).open()}else try{let c={selectedText:i},u=(void 0)(n.content,c);t.getSelection()?t.replaceSelection(u):t.replaceRange(u,o)}catch(c){console.error("Template processing error:",c),new h.Notice(`Template error: ${c instanceof Error?c.message:String(c)}`)}})})}))}))}},I=class extends h.Modal{constructor(e,t,s,n){super(e);this.templates=t,this.selectedText=s,this.onSubmit=n}onOpen(){let{contentEl:e}=this;e.addClass("template-selection-modal"),e.createEl("h2",{text:"Select Template"}),this.templates.forEach(t=>{new h.Setting(e).setName(t.name).addButton(s=>s.setButtonText("Use").setCta().onClick(()=>{var n,r;if(this.close(),t.params&&t.params.length>0){let i=this.selectedText||((n=t.defaultValues)==null?void 0:n.selectedText)||"",o={};t.params.forEach(p=>{var c;p==="selectedText"?o[p]=i:o[p]=((c=t.defaultValues)==null?void 0:c[p])||""}),new D(this.app,t,i,this.onSubmit,o).open()}else try{let o={selectedText:this.selectedText||((r=t.defaultValues)==null?void 0:r.selectedText)||""},p=(void 0)(t.content,o);this.onSubmit(p)}catch(i){console.error("Template processing error:",i),new h.Notice(`Template error: ${i instanceof Error?i.message:String(i)}`)}}))})}onClose(){let{contentEl:e}=this;e.empty()}},D=class extends h.Modal{constructor(e,t,s,n,r){super(e);this.paramValues={};this.paramInputs={};this.template=t,this.selectedText=s,this.onSubmit=n,this.template.params&&this.template.params.forEach(i=>{var o;r&&r[i]!==void 0?this.paramValues[i]=r[i]:i==="selectedText"&&s?this.paramValues[i]=s:this.paramValues[i]=((o=this.template.defaultValues)==null?void 0:o[i])||""})}onOpen(){let{contentEl:e}=this;if(e.addClass("template-parameter-modal"),!this.template.params||this.template.params.length===0){this.processTemplate(),this.close();return}e.createEl("h2",{text:"Enter Template Parameters"});let t=e.createEl("form");t.addEventListener("submit",s=>{s.preventDefault(),this.processTemplate()}),this.template.params.forEach(s=>{new h.Setting(t).setName(s).setDesc(`Enter value for ${s}`).addText(r=>{var o;this.paramInputs[s]=r;let i=this.paramValues[s]||((o=this.template.defaultValues)==null?void 0:o[s])||"";r.setValue(i).setPlaceholder(`Enter ${s}`).onChange(p=>{this.paramValues[s]=p})})}),new h.Setting(t).addButton(s=>s.setButtonText("Insert Template").setCta().onClick(()=>{this.template.params&&this.template.params.forEach(n=>{this.paramInputs[n]&&(this.paramValues[n]=this.paramInputs[n].getValue())}),this.processTemplate()})),setTimeout(()=>{var n,r;let s=(n=this.template.params)==null?void 0:n[0];s&&((r=this.paramInputs[s])!=null&&r.inputEl)&&this.paramInputs[s].inputEl.focus()},10)}processTemplate(){try{this.template.params&&this.template.params.forEach(s=>{this.paramInputs[s]&&(this.paramValues[s]=this.paramInputs[s].getValue())});let e={...this.paramValues};e.selectedText||(e.selectedText=this.selectedText),console.log("Template parameters:",this.template.params),console.log("Template default values:",this.template.defaultValues),console.log("Template input values:",this.paramValues),console.log("Final template data:",e);let t="";try{t=(void 0)(this.template.content,e),console.log("Rendered template:",t)}catch(s){console.error("Mustache render error:",s),t=this.template.content,Object.keys(e).forEach(n=>{let r=e[n]||"",i=new RegExp(`\\{\\{\\s*${n}\\s*\\}\\}`,"g");t=t.replace(i,r)}),t=t.replace(/\{\{#.*?\}\}[\s\S]*?\{\{\/.*?\}\}/g,""),console.log("Fallback rendered template:",t)}this.onSubmit(t),this.close()}catch(e){console.error("Template processing error:",e),new h.Notice(`Template error: ${e instanceof Error?e.message:String(e)}`)}}onClose(){let{contentEl:e}=this;e.empty()}},$=class extends h.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Template Manager"}),e.createEl("p",{text:"Create and manage your templates here."}),new h.Setting(e).setName("Add New Template").setDesc("Create a new template").addButton(s=>s.setButtonText("Add Template").setCta().onClick(()=>{this.plugin.settings.templates.push({id:String(Date.now()),name:"New Template",content:"{{selectedText}}",params:[],defaultValues:{},isCommand:!1}),this.plugin.saveSettings(),this.display()})),e.createEl("h3",{text:"Your Templates"});let t=e.createDiv("templates-container");t.createEl("p",{text:"Remember to Exit Obsidian APP and Referesh Data after Saving any changes."}),this.plugin.settings.templates.forEach((s,n)=>{let r=t.createDiv("template-item-container"),i=r.createDiv("template-header");i.createDiv("template-name").setText(s.name);let o=i.createDiv("template-toggle-container"),p=new h.Setting(o).setClass("template-command-toggle").addToggle(m=>{m.setValue(s.isCommand||!1).onChange(async y=>{s.isCommand=y,await this.plugin.saveSettings(),this.plugin.registerTemplateCommands()})}),c=r.createDiv("template-preview-container"),u=s.content?s.content.substring(0,s.content.length>100?100:s.content.length):"<empty>";c.createEl("input",{type:"text",attr:{readonly:"readonly",value:u,style:"width: 100%; border: 1px solid var(--background-modifier-border); border-radius: 4px; padding: 8px;"}});let g=r.createDiv("template-button-container");g.createEl("button",{text:"Edit",cls:"template-edit-button"}).addEventListener("click",()=>{new F(this.app,s,async m=>{this.plugin.settings.templates[n]=m,await this.plugin.saveSettings(),this.display()}).open()}),g.createEl("button",{text:"Delete",cls:"template-delete-button"}).addEventListener("click",async()=>{this.plugin.settings.templates.splice(n,1),await this.plugin.saveSettings(),this.display()})})}},F=class extends h.Modal{constructor(e,t,s){super(e);this.templateParams=[];this.templateDefaultValues={};this.template=t,this.onSubmit=s,this.templateContent=t.content,this.templateName=t.name,this.templateParams=t.params?[...t.params]:[],this.templateDefaultValues=t.defaultValues?{...t.defaultValues}:{},this.templateIsCommand=t.isCommand||!1}onOpen(){let{contentEl:e}=this;e.addClass("template-edit-modal"),e.createEl("h2",{text:"Edit Template"}),new h.Setting(e).setName("Template Name").addText(r=>r.setPlaceholder("Template name").setValue(this.templateName).onChange(i=>{this.templateName=i})),new h.Setting(e).setName("Add to right-click menu command").setDesc("Add this template to the context menu on the right side of the editor").addToggle(r=>{r.setValue(this.templateIsCommand).onChange(i=>{this.templateIsCommand=i})}),e.createEl("h3",{text:"Template Content"}),e.createEl("p",{text:"Use {{paramName}} for parameters. {{selectedText}} is always available.",cls:"setting-item-description"});let s=e.createDiv().createEl("textarea",{attr:{rows:"10",style:"width: 100%; font-family: monospace;"}});s.value=this.templateContent,s.addEventListener("input",r=>{let i=r.target;this.templateContent=i.value;let o=this.app.plugins.plugins["obsidian-template-inserter"];if(o){let p=o.extractParamsFromTemplate(this.templateContent);p.forEach(c=>{this.templateParams.includes(c)||(this.templateDefaultValues[c]="")}),this.templateParams.forEach(c=>{!p.includes(c)&&this.templateDefaultValues[c]!==void 0&&delete this.templateDefaultValues[c]}),this.templateParams=p,this.updateParamsList()}}),e.createEl("h3",{text:"Template Parameters & Default Values"});let n=e.createDiv("template-params-container");this.updateParamsList(n),new h.Setting(e).addButton(r=>r.setButtonText("Save Template").setCta().onClick(()=>{let i={id:this.template.id,name:this.templateName,content:this.templateContent,params:this.templateParams,defaultValues:this.templateDefaultValues,isCommand:this.templateIsCommand};this.onSubmit(i),this.close()}))}updateParamsList(e){if(!e){let t=this.contentEl.querySelector(".template-params-container");if(!t)return;e=t}e.empty(),this.templateParams.length===0?e.createEl("p",{text:"No parameters detected. Use {{paramName}} syntax in your template.",cls:"no-params-message"}):this.templateParams.forEach(t=>{e&&new h.Setting(e).setName(t).setDesc("Set default value (optional)").addText(n=>{let r=this.templateDefaultValues[t]||"";n.setPlaceholder("Default value").setValue(r).onChange(i=>{this.templateDefaultValues[t]=i})})})}onClose(){let{contentEl:e}=this;e.empty()}};
/*! Bundled license information:

mustache/mustache.mjs:
  (*!
   * mustache.js - Logic-less {{mustache}} templates with JavaScript
   * http://github.com/janl/mustache.js
   *)
*/
